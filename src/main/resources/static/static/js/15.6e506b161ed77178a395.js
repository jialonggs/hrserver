webpackJsonp([15],{Ciec:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Z0/y")(null,null,!1,null,null,null);t.default=i.exports},F6Rv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});a("P6Ff");var i=a("OIbc"),s=a("+J3q"),r={components:{VueCoreImageUpload:i.default},data:function(){return{pkGuid:"",shouMoId:"",mouldPartLoading:!1,updateId:"",partsInfos:[],nowTab:1,mojuCard:!1,moJuDisable:!1,form:{mouldNum:1,addUserId:"",addUserName:"",shouMoId:"",picUrls:""},upload:"",imageData:{userId:"",imgPakage:"sfm_shou"},imageUrls:[],tableLoading:!1,changeDisable:!0,toAddDisable:!1,currentPage:1,totalnum:0,pagesize:10,select_word:"",tableData:[],username:"",uid:"",batch:"",upadteDisabled:!1,tiem_disablse:!1,part_disable:!1,chomgzi_dis:!1,update_disablse:!1,base_disablse:!1,doc_collect_id:"",dialogFormVisible:!1,itemForm:{},ruleForm:{createTime:"",addUserName:"",addUserId:"",woodenCaseNum:"0",palletNum:"0",diaoHuanNum:"0",clientCompanyName:"",freightType:"",carNum:"",jianBao:!1,driverPhone:""},rules:{clientCompanyName:[{min:1,max:64,message:"长度在 1 到 64 个字符",trigger:"blur"}],freightType:[{required:!0,message:"请至少选择一种运输方式",trigger:"blur"}],carNum:[{min:8,max:24,message:"长度在 8 到 24 个字符",trigger:"blur"}],driverPhone:[{min:11,max:11,message:"请检查手机号码格式",trigger:"blur"}],remark:[{min:0,max:255,message:"长度在 0 到 255 个字符",trigger:"blur"}],mouldName:[{required:!0,message:"请输入模具名称",trigger:"blur"},{min:1,max:255,message:"长度在 1 到 255 个字符",trigger:"blur"}]}}},methods:{delMouldRecord:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.toDelPartInfo(e)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},toAddMould:function(){var e=this;this.$confirm("是否添加模具信息?","提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then(function(){e.toAddMouldRecord()}).catch(function(){e.getCollectMouldList()})},toDelPartInfo:function(e){var t=this,a=this;"undefined"!=e&&""!=e?this.getRequest("/shou/mo/del/mould?mouldId="+e).then(function(e){e&&200==e.status&&0==e.data.code?(t.toGetColletPartInfo(),a.$message.success("删除成功")):a.$message.error("删除失败")}):a.$message.error("删除出错")},toGetColletPartInfo:function(){var e=this;this.mouldPartLoading=!0;var t=this;if("undefined"==t.pkGuid||""==t.pkGuid)return this.mouldPartLoading=!1,void t.$message.error("获取模具列表失败");this.getRequest("/shou/mo/list/mouldinfo?shouMoId="+t.pkGuid).then(function(a){(e.mouldPartLoading=!1,a&&200==a.status&&0==a.data.code)?(e.partsInfos=[],a.data.data.forEach(function(e,a,i){var s=e.picUrls,r=[];"undefined"!=s&&""!=s&&(r=s.split("|"),e.picUrls=r),t.partsInfos.push(e)})):console.log("获取失败")})},to_update_partinfo:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(!e)return console.log("提交数据格式有误"),!1;var i=a.form;if(0!=a.imageUrls.length){for(var s="",r=0;r<a.imageUrls.length;r++)r==a.imageUrls.length-1?s+=a.imageUrls[r]:s=a.imageUrls[r]+"|"+s;i.picUrls=s,i.shouMoId=t.shouMoId,i.id=t.updateId,t.postRequest("/shou/mo/update/mouldinfo",i).then(function(e){e&&200==e.status&&0==e.data.code?(a.$message.success("更新成功"),a.resetForm("form"),a.imageUrls=[],t.nowTab=3,t.toGetColletPartInfo()):a.$message.error("更新失败")})}else a.$message.error("请上传必要图片")})},mouldInfos:function(e){this.nowTab=4,this.form=e,this.imageUrls=e.picUrls,this.part_disable=!0,this.shouMoId=e.shouMoId,this.updateId=e.id},toMojuLieBiao:function(){this.nowTab=3},toLieBiao:function(){this.nowTab=1,this.partsInfos=[]},mojuInfo:function(e){this.pkGuid=e.id;var t=[];if("undefined"!=(t=e.mouldInfos)&&t.length>0){var a=[];t.forEach(function(e,t,i){var s=e.picUrls,r=[];s instanceof Array?e.picUrls=s:"undefined"!=s&&""!=s&&(r=s.split("|"),e.picUrls=r),a.push(e),console.log(a)}),this.partsInfos=a}this.nowTab=3},addMouldInfos:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(!e)return!1;var i=a.form;if(0!=a.imageUrls.length){for(var s="",r=0;r<a.imageUrls.length;r++)r==a.imageUrls.length-1?s+=a.imageUrls[r]:s=a.imageUrls[r]+"|"+s;i.picUrls=s,i.addUserId=t.uid,i.addUserName=t.name,i.shouMoId=a.pkGuid,t.postRequest("/shou/mo/create/mouldinfo",i).then(function(e){e&&200==e.status&&0==e.data.code?(a.$message.success("添加成功"),a.resetForm("form"),a.imageUrls=[],a.nowTab=3,t.toGetColletPartInfo()):a.$message.error("添加失败")})}else a.$message.error("请上传必要图片")})},imageuploaded:function(e){if("undefined"!==e.url.length&&e.url.length>0){for(var t=e.url,a=this.imageUrls,i=0;i<t.length;i++)a.push(t[i]);this.imageUrls=a}},handleError:function(){this.$notify.error({title:"上传失败",message:"图片上传出现异常"})},todelImage:function(e){var t=this;"undefined"!=e&&""!=e.length?this.getRequest("/config/delfile/delImage?url="+e).then(function(a){if(a&&200==a.status&&0==a.data.code){t.$message.success("删除成功");for(var i=t.imageUrls,s=[],r=0;r<i.length;r++)e!=i[r]&&s.push(i[r]);t.imageUrls=s}else t.$message.error("删除照片失败")}):t.$message.error("删除图片不存在")},delMouldImage:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.todelImage(e)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},goBack:function(){this.nowTab=1,this.toAddDisable=!1,this.update_disablse=!1,this.tiem_disablse=!1},toAddMouldRecord:function(){this.nowTab=2,this.toAddDisable=!this.toAddDisable,this.tiem_disablse=!1,this.ruleForm={createTime:"",addUserName:"",addUserId:"",woodenCaseNum:"0",palletNum:"0",diaoHuanNum:"0",clientCompanyName:"",freightType:"",carNum:"",jianBao:!1,driverPhone:""},this.batch=""},chaKan:function(e){this.nowTab=2,this.tiem_disablse=!0,this.update_disablse=!0,this.ruleForm=e,this.batch=e.batch},updateCollectionInfo:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(!e)return!1;"undefined"!=a.ruleForm.id&&a.ruleForm.id+""!=""?t.putRequest("/shou/mo/update/baseinfo",a.ruleForm).then(function(e){e&&200==e.status&&0==e.data.code?(a.$message.success("修改成功"),a.goBack(),a.getCollectMouldList()):a.$message.error("修改失败")}):a.$message.error("修改失败")})},resetForm:function(e){this.$refs[e].resetFields(),"ruleForm"==e&&(this.ruleForm.createTime="",this.batch="")},submitForm:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(!e)return a.$message.error("请检查填写格式"),!1;a.ruleForm.addUserId=t.uid,a.ruleForm.addUserName=t.name,a.ruleForm.batch=t.batch,t.postRequest("/shou/mo/add/baseinfo",a.ruleForm).then(function(e){if(e&&200==e.status&&0==e.data.code){var i=e.data.data.id;-1==i?_this.$message.error("添加失败"):(a.doc_collect_id=i,a.nowTab=1,t.resetForm("ruleForm"),t.tableLoading=!0,a.$message.success("添加成功"),a.getCollectMouldList())}})})},toChange:function(){this.toInitBatch()},toInitBatch:function(){var e=this,t=e.ruleForm.createTime;""!=t&&"undefined"!=t?this.getRequest("/shou/mo/max/batch?dateTime="+t).then(function(t){if(t&&200==t.status&&0==t.data.code){var a=t.data.data+1;e.$nextTick(function(){this.batch="第"+a+"批次"})}else e.ruleForm.batch=""}):e.$message.error("请先设置收模时间")},toChangeDisable:function(){this.nowTab=4},toUpdate:function(){this.update_disablse=!0},handleChange:function(e){},handleSizeChange:function(e){this.pagesize=e,this.getCollectMouldList()},handleCurrentChange:function(e){this.currentPage=e,this.getCollectMouldList()},getCollectMouldList:function(){var e=this,t=this;this.getRequest("/shou/mo/listbypage?page="+this.currentPage+"&size="+this.pagesize).then(function(a){e.tableLoading=!1,a&&200==a.status&&0==a.data.code&&(t.tableData=a.data.data.shoumolist,console.log(t.tableData),t.totalnum=a.data.data.count)})}},mounted:function(){this.$nextTick(function(){this.imageData.userId=localStorage.getItem("cp_uid"),this.tableLoading=!0,this.getCollectMouldList()}),this.username=localStorage.getItem("cp_username"),this.uid=localStorage.getItem("cp_uid"),this.name=localStorage.getItem("cp_name")},created:function(){this.upload=s.a.upload},computed:{data:function(){var e=this;return e.tableData.filter(function(t){if(t.clientCompanyName.indexOf(e.select_word)>-1||t.addUserName.indexOf(e.select_word)>-1)return t})}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.nowTab,expression:"nowTab === 1"}]},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-menu"}),e._v("收模管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("收模列表")])],1)],1),e._v(" "),a("el-container",[a("el-header",{staticStyle:{padding:"0px",display:"flex","justify-content":"space-between","align-items":"center","margin-top":"20px"}},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"mr10",attrs:{type:"primary",icon:"plus"},on:{click:e.toAddMouldRecord}},[e._v("增添收模记录")]),e._v(" "),a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"筛选关键词",icon:"search"},model:{value:e.select_word,callback:function(t){e.select_word=t},expression:"select_word"}})],1)]),e._v(" "),a("el-main",{staticStyle:{"padding-left":"0px","padding-top":"0px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.data,stripe:""}},[a("el-table-column",{attrs:{prop:"createTime",align:"center",label:"日期"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("formatDateTime")(t.row.createTime)))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"batch",align:"center",label:"批次"}}),e._v(" "),a("el-table-column",{attrs:{prop:"clientCompanyName",align:"center",label:"客户单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"mouldNum",align:"center",label:"模具总数"}}),e._v(" "),a("el-table-column",{attrs:{prop:"addUserName",align:"center",label:"添加人"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.chaKan(t.row)}}},[e._v("基础详情")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(a){e.mojuInfo(t.row)}}},[e._v("模具信息")])]}}])})],1)],1)],1),e._v(" "),a("div",{staticClass:"block",staticStyle:{float:"right","margin-top":"15px"}},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,30,80,100],"page-size":e.pagesize,layout:"total,sizes, prev, pager, next, jumper",total:e.totalnum},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:3==e.nowTab,expression:"nowTab==3"}]},[a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-menu"}),e._v("收模管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("模具信息")])],1)],1),e._v(" "),a("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"25px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("模具信息")])]),e._v(" "),a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("div",{on:{click:e.toChangeDisable}},[a("el-card",{staticClass:"mould-card",staticStyle:{"min-height":"460px"}},[a("div",{staticStyle:{padding:"14px"}},[a("img",{staticClass:"image"}),e._v(" "),a("i",{staticClass:"el-icon-plus"},[e._v("添加模具记录")])])])],1)]),e._v(" "),e._l(e.partsInfos,function(t){return a("el-col",{attrs:{span:6}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.mouldPartLoading,expression:"mouldPartLoading"}],staticClass:"mould-card",attrs:{"body-style":{padding:"0px"}}},[a("img",{staticClass:"image",attrs:{src:t.picUrls[0]}}),e._v(" "),a("div",{staticStyle:{padding:"14px"}},[a("h4",[e._v(e._s(t.mouldName))]),e._v(" "),a("span",[e._v("备注："+e._s(t.remark))]),e._v(" "),a("div",{staticClass:"bottom clearfix"},[a("time",{staticClass:"time"}),e._v(" "),a("el-dropdown",{staticStyle:{float:"right",color:"#409EFF"}},[a("span",{staticClass:"el-dropdown-link"},[a("i",{staticClass:"el-icon-edit"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.mouldInfos(t)}}},[e._v("详情")])],1),e._v(" "),a("el-dropdown-item",[a("el-button",{attrs:{type:"text",disabled:e.upadteDisabled},on:{click:function(a){e.delMouldRecord(t.id)}}},[e._v("删除")])],1)],1)],1)],1)])])],1)})],2)],1),e._v(" "),a("div",{staticClass:"card-bottom"},[a("el-button",{staticStyle:{float:"left !important"},attrs:{type:"primary"},on:{click:e.toLieBiao}},[e._v("返回")])],1)])],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:4==e.nowTab,expression:"nowTab == 4"}]},[a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-menu"}),e._v("收模管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("增添收模")]),e._v(" "),a("el-breadcrumb-item",[e._v("模具详情")])],1)],1),e._v(" "),a("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"25px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("基础信息")])]),e._v(" "),a("div",{staticClass:"form-box"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"120px",rules:e.rules}},[a("el-form-item",{attrs:{label:"模具名称：",prop:"mouldName"}},[a("el-input",{staticStyle:{width:"28%"},attrs:{placeholder:"请输入模具名称"},model:{value:e.form.mouldName,callback:function(t){e.$set(e.form,"mouldName",t)},expression:"form.mouldName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"模具数量：",prop:"mouldNum"}},[a("el-input-number",{attrs:{"controls-position":"right",min:1},on:{change:e.handleChange},model:{value:e.form.mouldNum,callback:function(t){e.$set(e.form,"mouldNum",t)},expression:"form.mouldNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注：",prop:"remark"}},[a("el-input",{staticStyle:{width:"28%"},attrs:{type:"textarea"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"上传图片："}},[a("div",[a("vue-core-image-upload",{class:["el-button","el-button--primary"],attrs:{crop:!1,inputOfFile:"imageFile",url:e.upload,extensions:"png,gif,jpeg,jpg","max-file-size":5242880,data:e.imageData,text:"上传图片",multiple:!0,"multiple-size":30,credentials:"true"},on:{imageuploaded:e.imageuploaded,errorhandle:e.handleError}})],1)])],1)],1),e._v(" "),a("div",{staticStyle:{border:"1px dashed #d9d9d9",width:"100%","min-height":"358px"}},[a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{gutter:20}},e._l(e.imageUrls,function(t){return a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"mould-card",attrs:{"body-style":{padding:"0px"}}},[a("img",{staticClass:"image",staticStyle:{height:"420px"},attrs:{src:t}}),e._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.delMouldImage(t)}}},[a("i",{staticClass:"el-icon-error",staticStyle:{color:"red"}})])],1)])],1)}))],1),e._v(" "),a("div",{staticClass:"card-bottom"},[a("el-button",{staticStyle:{float:"left !important"},attrs:{type:"primary"},on:{click:e.toMojuLieBiao}},[e._v("返回")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!1===e.part_disable,expression:"part_disable === false"}],attrs:{type:"primary"},on:{click:function(t){e.addMouldInfos("form")}}},[e._v("提交")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!0===e.part_disable,expression:"part_disable === true"}],attrs:{type:"primary"},on:{click:function(t){e.to_update_partinfo("form")}}},[e._v("更新")])],1)])],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:2==e.nowTab,expression:"nowTab==2"}],staticStyle:{width:"100%",float:"right"}},[a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-menu"}),e._v("收模管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("收模详情")])],1)],1),e._v(" "),a("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"25px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("收模基础信息")])]),e._v(" "),a("div",[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"110px"}},[a("el-form-item",{attrs:{label:"批次：",prop:"batch"}},[a("el-input",{staticStyle:{width:"28%"},attrs:{placeholder:"设置时间后会自动判断批次",disabled:!0},model:{value:e.batch,callback:function(t){e.batch=t},expression:"batch"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"收模时间：",prop:"createTime",required:""}},[a("el-date-picker",{staticStyle:{width:"28%"},attrs:{disabled:e.tiem_disablse,format:"yyyy 年 MM 月 dd 日 HH:mm:ss","value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期时间"},on:{change:e.toChange},model:{value:e.ruleForm.createTime,callback:function(t){e.$set(e.ruleForm,"createTime",t)},expression:"ruleForm.createTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"客户单位：",prop:"clientCompanyName"}},[a("el-input",{staticStyle:{width:"28%"},attrs:{placeholder:"请输入客户单位名称",disabled:e.base_disablse},model:{value:e.ruleForm.clientCompanyName,callback:function(t){e.$set(e.ruleForm,"clientCompanyName",t)},expression:"ruleForm.clientCompanyName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"运输方式：",prop:"freightType"}},[a("el-radio-group",{attrs:{disabled:e.base_disablse},model:{value:e.ruleForm.freightType,callback:function(t){e.$set(e.ruleForm,"freightType",t)},expression:"ruleForm.freightType"}},[a("el-radio",{attrs:{label:"快递"}}),e._v(" "),a("el-radio",{attrs:{label:"货运"}}),e._v(" "),a("el-radio",{attrs:{label:"专车"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"车牌号：",prop:"carNum"}},[a("el-input",{staticStyle:{width:"28%"},attrs:{placeholder:"请输入车牌号",disabled:e.base_disablse},model:{value:e.ruleForm.carNum,callback:function(t){e.$set(e.ruleForm,"carNum",t)},expression:"ruleForm.carNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"驾驶员手机号：",prop:"driverPhone"}},[a("el-input",{staticStyle:{width:"28%"},attrs:{placeholder:"请输入手机号",disabled:e.base_disablse},model:{value:e.ruleForm.driverPhone,callback:function(t){e.$set(e.ruleForm,"driverPhone",t)},expression:"ruleForm.driverPhone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"包装方式："}},[a("div",{staticStyle:{border:"1px dashed #d9d9d9",width:"40%","min-height":"128px"}},[a("el-form-item",{attrs:{label:"简包：",prop:"jianBao"}},[a("el-switch",{attrs:{disabled:e.base_disablse,"active-text":"是","inactive-text":"否"},model:{value:e.ruleForm.jianBao,callback:function(t){e.$set(e.ruleForm,"jianBao",t)},expression:"ruleForm.jianBao"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"木箱：",prop:"woodenCaseNum"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,disabled:e.base_disablse},on:{change:e.handleChange},model:{value:e.ruleForm.woodenCaseNum,callback:function(t){e.$set(e.ruleForm,"woodenCaseNum",t)},expression:"ruleForm.woodenCaseNum"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"托盘：",prop:"palletNum"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,disabled:e.base_disablse},on:{change:e.handleChange},model:{value:e.ruleForm.palletNum,callback:function(t){e.$set(e.ruleForm,"palletNum",t)},expression:"ruleForm.palletNum"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"margin-top":"10px"},attrs:{label:"吊环：",prop:"diaoHuanNum"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0,disabled:e.base_disablse},on:{change:e.handleChange},model:{value:e.ruleForm.diaoHuanNum,callback:function(t){e.$set(e.ruleForm,"diaoHuanNum",t)},expression:"ruleForm.diaoHuanNum"}})],1)],1)])],1)],1),e._v(" "),a("div",[a("div",{staticClass:"card-bottom"},[a("el-button",{staticStyle:{float:"left"},attrs:{type:"primary"},on:{click:e.goBack}},[e._v("返 回 ")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!0===e.toAddDisable,expression:"toAddDisable === true"}],staticStyle:{float:"right"},on:{click:function(t){e.resetForm("ruleForm")}}},[e._v("重 置")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!0===e.toAddDisable,expression:"toAddDisable === true"}],staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("保 存")]),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!0===e.update_disablse,expression:"update_disablse === true "}],staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){e.updateCollectionInfo("ruleForm")}}},[e._v("提 交")])],1)])])],1)])])},staticRenderFns:[]};var o=a("Z0/y")(r,l,!1,function(e){a("QrH0")},"data-v-2b5bf2bc",null);t.default=o.exports},QrH0:function(e,t){},j0AK:function(e,t){},nZPv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={data:function(){return{update_mould_name:"",tree_loading:!1,update_disable:!1,username:"",uid:"",name:"",nowTab:1,select_part:[],data3:[],select_mould_word:"",select_mould:"",selectedM:{num:0,time:"",value:"",label:""},filterText:"",defaultProps:{children:"children",label:"label"},moulds:[],currentPage:1,totalnum:0,pagesize:10,select_word:"",tableData:[],tableLoading:!1,exfrom:{addUserId:"",mouldId:"",addUserName:"0",youSiWenNum:"0",wuSiWenNum:"0",remark:""},rules:{mouldName:[{required:!0,message:"请输入模具名称",trigger:"blur"},{min:1,max:255,message:"长度在 1 到 255 个字符",trigger:"blur"}]}}},methods:{addSelected:function(e){var t=this.select_part;if(0===t.length)e.collectPartinfoEntity.picurl instanceof Array?t.push(e):(e.collectPartinfoEntity.picurl=this.splitUrl(e.collectPartinfoEntity),t.push(e));else{for(var a=!0,i=0;i<t.length;i++)if(t[i].id===e.id){a=!1;break}a&&(e.collectPartinfoEntity.picurl instanceof Array?t.push(e):(e.collectPartinfoEntity.picurl=this.splitUrl(e.collectPartinfoEntity),t.push(e)))}},splitUrl:function(e){var t=e.picUrls,a=[];return"undefined"!=t&&""!=t&&(a=t.split("|")),a},delSelected:function(e){for(var t=this.select_part,a=[],i=0;i<t.length;i++)t[i].id!==e.id&&a.push(t[i]);this.select_part=a},toChangeCheck:function(e,t){var a=e.disabled;t&&!a?"undefined"!==e.collectPartinfoEntity&&this.addSelected(e):t||a||"undefined"!==e.collectPartinfoEntity&&this.delSelected(e)},filterNode:function(e,t){return!e||-1!==t.label.indexOf(e)},getMouldTree:function(){var e=this,t=this;this.getRequest("/shou/cai/mould/tree").then(function(a){e.tree_loading=!1,a&&200==a.status&&0==a.data.code&&(t.data3=a.data.data.tree)})},toUpdate:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(!e)return!1;a.exfrom.mouldId=t.selectedM.value,t.putRequest("/shou/cai/update",a.exfrom).then(function(e){if(e&&200==e.status&&0==e.data.code){e.data.data.id;t.tableLoading=!0,t.$message.success("修改成功"),t.nowTab=1,t.resetForm("exfrom"),t.selectedM={},t.getCollectMouldList()}else t.$message.error("修改失败")})})},goBack:function(){this.nowTab=1,this.update_disable=!1},toGetAllInfo:function(e){this.update_disable=!0,this.exfrom.mouldId=e.mouldId,this.exfrom.id=e.id,this.exfrom.youSiWenNum=e.youSiWenNum,this.exfrom.wuSiWenNum=e.wuSiWenNum,this.exfrom.remark=e.remark,e.mouldInfo.mouldNum+""==""?this.selectedM.num=0:this.selectedM.num=e.mouldInfo.mouldNum+"",this.selectedM.time=e.mouldInfo.createTime,this.selectedM.value=e.mouldInfo.id,this.update_mould_name=e.mouldInfo.mouldName,this.nowTab=2},toSelect:function(){var e=this;""==e.select_mould_word&&e.$message.error("请输入模具名称或添加人姓名"),this.getRequest("/shou/mo/select?mouldName="+e.select_mould_word+"&addUserName="+e.select_mould_word).then(function(t){if(t&&200==t.status&&0==t.data.code){e.$message.success("查找成功，请左侧点击选择");for(var a=t.data.data,i=[],s=0;s<a.length;s++){var r={label:"",value:"",time:"",num:""};r.label=a[s].mouldName,r.value=a[s].id,r.num=a[s].mouldNum,r.time=a[s].createTime,i.push(r)}e.moulds=i}else e.$message.success("信息不存在")})},loadAllProject:function(){var e=this;this.getRequest("/shou/mo/get/byday").then(function(t){if(t&&200==t.status&&0==t.data.code){for(var a=[],i=t.data.data,s=0;s<i.length;s++){var r={label:"",value:"",time:"",num:""};r.label=i[s].mouldName,r.value=i[s].id,r.num=i[s].mouldNum,r.time=i[s].createTime,a.push(r)}e.moulds=a}else console.log("获取列表数据失败")})},toAddMouldRecord:function(){this.nowTab=2,this.exfrom={addUserId:"",mouldId:"",addUserName:"0",youSiWenNum:"0",wuSiWenNum:"0",remark:""},this.loadAllProject()},delMouldRecord:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.toDelPartInfo(e)}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},resetForm:function(e){this.$refs[e].resetFields()},submitForm:function(e){var t=this,a=this;this.$refs[e].validate(function(e){if(!e)return!1;if(a.exfrom.addUserId=t.uid,a.exfrom.addUserName=t.name,t.select_part.length<=0)t.$message.error("请选择模具");else{for(var i="",s=0;s<t.select_part.length;s++)i=i+t.select_part[s].id+",";a.exfrom.mouldString=i,t.putRequest("/shou/cai/createNew",a.exfrom).then(function(e){if(e&&200==e.status&&0==e.data.code){e.data.data.id;t.tableLoading=!0,t.$message.success("添加成功"),t.nowTab=1,t.resetForm("exfrom"),t.selectedM={},t.select_part=[],t.getMouldTree(),t.getCollectMouldList()}else t.$message.success("添加失败")})}})},handleChange:function(e){},handleSizeChange:function(e){this.pagesize=e,this.getCollectMouldList()},handleCurrentChange:function(e){this.currentPage=e,this.getCollectMouldList()},getCollectMouldList:function(){var e=this;this.getRequest("/shou/cai/listbypage?page="+this.currentPage+"&size="+this.pagesize).then(function(t){e.tableLoading=!1,t&&200==t.status&&0==t.data.code&&(e.tableData=t.data.data.caiMoList,e.totalnum=t.data.data.count)})}},mounted:function(){this.$nextTick(function(){this.tableLoading=!0,this.getCollectMouldList()}),this.username=localStorage.getItem("cp_username"),this.uid=localStorage.getItem("cp_uid"),this.name=localStorage.getItem("cp_name"),this.tree_loading=!0,this.getMouldTree()},computed:{data:function(){var e=this;return e.tableData.filter(function(t){if(t.addUserName.indexOf(e.select_word)>-1)return t})}}},s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:1===e.nowTab,expression:"nowTab === 1"}]},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-menu"}),e._v("收模管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("拆模记录")])],1)],1),e._v(" "),a("el-container",[a("el-header",{staticStyle:{padding:"0px",display:"flex","justify-content":"space-between","align-items":"center","margin-top":"20px"}},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"mr10",attrs:{type:"primary",icon:"plus"},on:{click:e.toAddMouldRecord}},[e._v("增添拆模记录")]),e._v(" "),a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"筛选关键词",icon:"search"},model:{value:e.select_word,callback:function(t){e.select_word=t},expression:"select_word"}})],1)]),e._v(" "),a("el-main",{staticStyle:{"padding-left":"0px","padding-top":"0px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.data,stripe:""}},[a("el-table-column",{attrs:{align:"center",prop:"mouldName",label:"模具名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.mouldInfo.mouldName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"mouldNum",label:"数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.mouldInfo.mouldNum))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"收模时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatDateTime")(t.row.mouldInfo.createTime)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"addUserName",label:"拆模人"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",prop:"remark",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){e.toGetAllInfo(t.row)}}},[e._v("查看详情")])]}}])})],1)],1)],1),e._v(" "),a("div",{staticClass:"block",staticStyle:{float:"right","margin-top":"15px"}},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,30,80,100],"page-size":e.pagesize,layout:"total,sizes, prev, pager, next, jumper",total:e.totalnum},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:2==e.nowTab,expression:"nowTab==2"}],staticStyle:{width:"100%",float:"right"}},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-menu"}),e._v("收模管理")]),e._v(" "),a("el-breadcrumb-item",[e._v("拆模记录")]),e._v(" "),a("el-breadcrumb-item",[e._v("拆模详情")])],1)],1),e._v(" "),a("div",[a("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"25px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("选择模具")])]),e._v(" "),a("div",[a("el-row",{attrs:{gutter:30}},[a("el-col",{directives:[{name:"loading",rawName:"v-loading",value:e.tree_loading,expression:"tree_loading"}],attrs:{span:4}},[a("el-input",{attrs:{placeholder:"输入关键字进行过滤"},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),[a("div",{staticStyle:{height:"600px"}},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("div",{staticStyle:{width:"400px"}},[a("el-tree",{ref:"tree2",staticClass:"filter-tree",staticStyle:{"border-right":"1px solid #e6e6e6","min-height":"260px"},attrs:{data:e.data3,props:e.defaultProps,"default-expand-all":"","filter-node-method":e.filterNode,"show-checkbox":"","node-key":"id"},on:{"check-change":e.toChangeCheck}})],1)])],1)]],2),e._v(" "),a("el-col",{attrs:{span:20}},[a("div",{staticStyle:{"min-height":"15px",width:"100%"}},[a("el-row",{attrs:{gutter:30}},e._l(e.select_part,function(t){return a("el-col",{attrs:{span:6}},[a("el-card",{staticClass:"mould-card",attrs:{"body-style":{padding:"0px"}}},[a("img",{staticClass:"image",staticStyle:{height:"260px"},attrs:{src:t.collectPartinfoEntity.picurl[0]}}),e._v(" "),a("div",{staticStyle:{padding:"14px"}},[a("h4",[e._v(e._s(t.collectPartinfoEntity.mouldName))]),e._v(" "),a("span",[e._v("备注："+e._s(t.collectPartinfoEntity.remark))]),e._v(" "),a("div",{staticClass:"bottom clearfix"},[a("time",{staticClass:"time"},[e._v(e._s(t.collectPartinfoEntity.createTime))])])])])],1)}))],1)])],1)],1)])],1),e._v(" "),a("el-card",{staticClass:"box-card",staticStyle:{"margin-top":"25px"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("拆模基础信息")])]),e._v(" "),a("div",[a("div",{staticClass:"form-box"},[a("el-form",{ref:"exfrom",attrs:{model:e.exfrom,rules:e.rules,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"蚀纹镶块：",prop:"youSiWenNum"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0},on:{change:e.handleChange},model:{value:e.exfrom.youSiWenNum,callback:function(t){e.$set(e.exfrom,"youSiWenNum",t)},expression:"exfrom.youSiWenNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"无蚀纹镶块：",prop:"wuSiWenNum"}},[a("el-input-number",{attrs:{"controls-position":"right",min:0},on:{change:e.handleChange},model:{value:e.exfrom.wuSiWenNum,callback:function(t){e.$set(e.exfrom,"wuSiWenNum",t)},expression:"exfrom.wuSiWenNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"备注："}},[a("el-input",{staticStyle:{width:"28%"},attrs:{type:"textarea"},model:{value:e.exfrom.remark,callback:function(t){e.$set(e.exfrom,"remark",t)},expression:"exfrom.remark"}})],1)],1)],1)]),e._v(" "),a("div",{staticClass:"card-bottom"},[e.update_disable?e._e():a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("exfrom")}}},[e._v("确 定")]),e._v(" "),e.update_disable?a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.toUpdate("exfrom")}}},[e._v("修 改")]):e._e(),e._v(" "),a("el-button",{on:{click:e.goBack}},[e._v("取 消")])],1)])],1)])},staticRenderFns:[]};var r=a("Z0/y")(i,s,!1,function(e){a("j0AK")},"data-v-7c6caa55",null);t.default=r.exports},qa5Q:function(e,t,a){var i={"./ChaiMoList.vue":"Ciec","./ShouCaiList.vue":"nZPv","./ShouList.vue":"F6Rv"};function s(e){return a(r(e))}function r(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}s.keys=function(){return Object.keys(i)},s.resolve=r,e.exports=s,s.id="qa5Q"}});
//# sourceMappingURL=15.6e506b161ed77178a395.js.map